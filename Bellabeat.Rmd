---
title: "Bellabeat Capstone Project"
output: html_notebook
---
I am a junior analyst and have been tasked with understanding how fitness devices are being utilized.  This is for the final project for the Google Data Analytics Certificate.  

Bellabeat is a company founded by Urska Srsen and Sando Mur in 2013.  We have been asked to focus on one of their products and then present our findings to them.

Bellabeat has four products: Bellabeat app, Leaf, Time, Spring, and their membership. 

Prepare
The dataset used is FitBit Fitness Tracker Data.  The data is stored on Kaggle.  The data is open-source.  We are able to use, copy, and analyze the data for commerical purposes.  The dataset has information from thirty three people and monitors heartrate, steps, sleep information, METs, and calorie information.  
We have no information about any of the subjects in the data so there is no way to rule out a sampling bias.  The data is also not current and so is probably not as useful now as technology and fitness products have increased exponentially in the last ten years.  Also thirty three is a very small sample.  The data is also only for a period of two months which makes it not as useful or informative as a year long study with more participants.

Process
I will first install and then load the packages that I will need to use.

```{r}
install.packages("tidyverse")
install.packages("janitor")
install.packages("skimr")
install.packages("here")


library(tidyverse)
library(janitor)
library(skimr)
library(here)
library(dplyr)
library(scales)
```

I will then import the data. I downloaded the data from the dataset available on Kaggle and then used the RStudio app on my desktop computer. I renamed the files to be easier to read.

```{r}
daily_activity <- dailyActivity_mergedApril
daily_steps <- dailySteps_merged
daily_sleep <- sleepDay_merged
hourly_steps <- hourlySteps_merged
hourly_calories <- hourlyCalories_merged
hourly_intensities <- hourlyIntensities_merged
weight <- weightLogInfo_merged
met_narrow <- minuteMETsNarrow_merged
```

I then wanted just a summary of the data I was looking at before beginning clean it.

```{r}
str(daily_activity)
str(daily_steps)
str(daily_sleep)
str(hourly_steps)
str(hourly_calories)
str(weight)
str(met_narrow)
```

I then checked the data for the number of participants.

```{r}
n_unique(daily_activity$Id)
n_unique(daily_sleep$Id)
n_unique(daily_steps$Id)
n_unique(hourly_calories$Id)
n_unique(hourly_intensities$Id)
n_unique(hourly_steps$Id)
n_unique(weight$Id)
n_unique(met_narrow$Id)
```

All of the datasets have the thirty three participants except weight and daily sleep which only have 8 and 24 participants respectively.

I will then clean the names to make sure everything is lower case.

```{r}
clean_names(daily_activity)
daily_activity <- rename_with(daily_activity, tolower)
clean_names(daily_sleep)
daily_sleep <- rename_with(daily_sleep, tolower)
clean_names(daily_steps)
daily_steps <- rename_with(daily_steps, tolower)
clean_names(hourly_calories)
hourly_calories <- rename_with(hourly_calories, tolower)
clean_names(hourly_intensities)
hourly_intensities <- rename_with(hourly_intensities, tolower)
clean_names(hourly_steps)
hourly_steps <- rename_with(hourly_steps, tolower)
clean_names(weight)
weight <- rename_with(weight, tolower)
clean_names(met_narrow)
met_narrow <- rename_with(met_narrow, tolower)
```

I then wanted to make sure that every set had some of the same columns for merging.  Daily steps and daily activity to not have a time column.  So I wanted to separate the time from the date columns in all the rest of the data and change the column name in daily activity to be date instead of Activitydate.

```{r}
daily_sleep <- daily_sleep %>%
   separate(sleepday, c("date", "time"), " ")
weight <- weight %>%
  separate(date, c("date", "time"), " ")
hourly_intensities <- hourly_intensities %>%
  separate(activityhour, c("date", "time"), " ")
hourly_steps <- hourly_steps %>%
  separate(activityhour, c("date", "time"), " ")
hourly_calories <- hourly_calories %>%
  separate(activityhour, c("date", "time"), " ")
daily_activity <- daily_activity %>%
  rename(date = activitydate)
met_narrow <- met_narrow %>%
  separate(activityminute, c("date", "time"), " ")
```

I then checked for duplicates in the data.

```{r}
sum(duplicated(daily_activity))
sum(duplicated(daily_sleep))
sum(duplicated(daily_steps))
sum(duplicated(hourly_calories))
sum(duplicated(hourly_intensities))
sum(duplicated(hourly_steps))
sum(duplicated(weight))
sum(duplicated(met_narrow))
```

I then removed the duplicates.

```{r}
daily_activity <- daily_activity %>%
  distinct() %>%
  drop_na()
daily_sleep <- daily_sleep %>%
  distinct() %>%
  drop_na()
daily_steps <- daily_steps %>%
  distinct() %>%
  drop_na()
hourly_calories <- hourly_calories %>%
  distinct() %>%
  drop_na()
hourly_intensities <- hourly_intensities %>%
  distinct() %>%
  drop_na()
hourly_steps <- hourly_steps %>%
  distinct() %>%
  drop_na()
weight <- weight %>%
  distinct() %>%
  drop_na()
met_narrow <- met_narrow %>%
  distinct() %>%
  drop_na()
```

I then merged daily activity with daily sleep and the infomration about mets.

```{r}
daily_activity_sleep_mets <- merge(daily_activity_sleep_met, met_narrow, by=c ("id", "date"))
```

After merging, I also wanted to be able to see what day, and not just date, everything was occuring on.  Maybe being able to analyze if the devices were used during the week or the weekend would be helpful information.

```{r}
daily_activity_sleep_mets <-
  daily_activity_sleep_mets %>%
  mutate(day = wday(date, label = TRUE, abbr = FALSE), .after = date)
```

Analyze
I can now begin analyzing the data and looking for insights about how consumers use their fitbit devices.

```{r}
daily_activity_sleep_mets %>%
  select(totalsteps, totaldistance, veryactiveminutes, fairlyactiveminutes, lightlyactiveminutes, sedentaryminutes, calories, mets) %>%
  summary()
daily_activity %>%
  select(totalsteps, totaldistance, sedentaryminutes, calories) %>%
  summary()
```

This shows us that the average steps per day were 7,638.  Depending on the age of the participant, this is a little low.  This amount is good for adults over 60, but lower than the recommended 8-10k for adults under 60.
We know from the Fitabase Data Dictionary that the METs are multiplied by 10.  So we need to divide by 10 to get accurate values.  This means the median MET is 1 and the average is 1.6.  A value of 1 MET is sedentary and a value of 3-5.9 is moderate activity.  So the average user is fairly sedentary.  The average calories burned are around 2300.  Through basal metabolic rate, humans burn somewhere between 1200 and 2000 calories per day depending on sex, age, height, weight, and muscle mass.  So this is another opportunity for further study because it is very hard to gain insights from this data without other information about the participants.  
```{r}
weightLogInfo_merged %>%
  select(WeightPounds,BMI) %>%
  summary()
```
 
 After looking at the summary for the weight information, I again come to the conclusion that we would need more data to understand what Bellabeat needs to know to attract consumers and what areas people want tracked.  The average BMI is 25.19 is just into the overweight category while the max of 47 is serverly obese.  Only eight of the participants voluntarily participated in this data.  Is this because people don't want to see their weight tracked daily?  Or was it not easy to load for the average person? Without this information, our analysis can not be complete.
 
```{r}
daily_activity_sleep_mets %>%
  select(totalminutesasleep, totaltimeinbed) %>%
  summary()
```

The average time asleep is 7 hours which is on the low end of healthy. It is also difficult to know if the maximum amounts are outliers due to faulty recording or meaning that some users were asleep for over thirteen hours.   

Share
I did a few plots to visualize the data.

```{r}
ggplot(data = daily_activity_sleep_mets, mapping = aes(x = totalsteps, y = calories)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  geom_jitter() + labs(title = "Total Steps vs. Calories")
```

```{r}
ggplot(data = totalactivity, aes(day, steptotal)) +
  geom_col(fill = "purple") +
  geom_hline(yintercept = 7000) +
  labs(title = "Total Steps per Day", x = "", y = "") +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1)) +
  scale_y_continuous(limits = c(0, 20000))
```

```{r}
ggplot(totalactivity, aes(day, totalminutesasleep)) +
  geom_col(fill = "pink") +
  geom_hline(yintercept = 480) +
  labs(title = "Minutes Asleep per Day", x="", y="") +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1)) +
  scale_y_continuous(limits = c(0, 500))
```

Act
Conclusion

There is some good data here, but I would recommend a much larger study and branching out from the average fitness app or device.
Health and fitness tracking is a growing market.  I think giving people goals through the app or watch would be ideal.
The CDC no longer recommends activity based on steps but rather on amount of time doing physical activity.  150 minutes per week of moderate-intensity physical activity.  Also people vary in how much activity they require to either maintain or lose weight.
So few people participated in the weight portion of this study, that it makes me wonder if it is anxiety related.  Maybe having a weigh in portion once per month rather than asking for daily weight amounts.  Combining weight, exercise, and diet could also be helpful.  Maybe have a new recipe option on the app or a calorie counter.
Giving users more positive feedback might also be helpful.  A weekly recap would be great.
Also the graph shows that users are not getting the recommended amount of sleep.  Helping them to do that or having links to information explaining the benefits might also be helpful.  Giving users a more well-rounded understanding of their health from the big picture and not just amount of steps they have taken will help this product grow and be more up to date.  Showing users how physical activity lowers their cancer risk with eight different cancers and other information like this.
I think an online campaign that shows users that this company looks at all aspects of their health and is a positive influence on their lives, not just a way to count steps would be an improvement.